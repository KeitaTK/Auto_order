# モノタロウ注文情報Excel作成ツール

## できること

このツールは、モノタロウ（MONOTARO）の商品URLから商品情報を自動取得し、Excel形式の注文リストを作成するGUIアプリケーションです。

### 主な機能

- **商品情報の自動取得**: モノタロウの商品ページURLから以下の情報を自動抽出
  - 仕入元（モノタロウ）
  - 商品コード
  - 商品名
  - 型番
  - 単価（税別）
  - 価格（税込）
  
- **Excel出力**:
  - 新規Excelファイルの作成
  - 既存Excelファイルへの追加
  
- **複数商品の一括処理**:
  - URLリストに複数の商品を追加して一括で変換
  - 各商品の個数を指定可能
  - 自動で合計金額を計算


## 環境構築手順

### 1. 仮想環境（venv）の作成

まず、プロジェクトディレクトリで仮想環境を作成します。

```powershell
# プロジェクトディレクトリに移動(実行ファイルがあるディレクトリ)
cd C:\Users\username\Documents\Local\Auto_order

# 仮想環境を作成（.venv という名前で作成）
python -m venv .venv
```

### 2. 仮想環境の有効化

VSCなどで仮想環境を作成するかパワーシェルのコマンドで有効にするか。以下はパワーシェルでの手順です。
作成した仮想環境を有効化します。

```powershell
# PowerShellの場合
.\.venv\Scripts\Activate.ps1

# その後、再度有効化コマンドを実行
.\.venv\Scripts\Activate.ps1
```

仮想環境が有効化されると、プロンプトの先頭に `(.venv)` が表示されます。

```
(.venv) PS C:\Users\username\Documents\Local\Auto_order>
```

### 3. 必要なライブラリのインストール

仮想環境を有効化した状態で、以下のコマンドを実行してライブラリをインストールします。

```powershell
# 必要なライブラリを一括インストール
pip install openpyxl requests beautifulsoup4
```

#### インストールされるライブラリの説明

- **openpyxl**: Excelファイル(.xlsx)の読み書きを行うライブラリ
- **requests**: HTTPリクエストを送信してWebページを取得するライブラリ
- **beautifulsoup4**: HTMLを解析して必要な情報を抽出するライブラリ

### 4. インストールの確認

正しくインストールされたか確認します。

```powershell
pip list
```

以下のようなパッケージが表示されれば成功です：

```
Package        Version
-------------- -------
beautifulsoup4 4.x.x
openpyxl       3.x.x
requests       2.x.x
soupsieve      2.x.x
...
```

## 使い方

### 1. アプリケーションの起動

```powershell
# 仮想環境を有効化した状態で
python monotaro.py
```

### 2. モード選択

GUIが起動したら、まず作業モードを選択します。

- **新規作成**: 新しいExcelファイルを作成
- **既存ファイルに追加**: 既にあるExcelファイルに商品を追加

### 3. ファイル設定

#### 新規作成の場合
1. 「ファイルパス」の「参照」ボタンをクリック
2. 保存先とファイル名を指定（例: `注文リスト.xlsx`）
3. 「シート名」を入力（デフォルト: `注文内容`）

#### 既存ファイルに追加の場合
1. 「ファイルパス」の「参照」ボタンをクリック
2. 追加したい既存のExcelファイルを選択

### 4. 商品情報の入力

1. **モノタロウ商品URL**: 商品ページのURLを入力
   - 例: `https://www.monotaro.com/p/1234/5678/`
   
2. **個数**: 注文する個数を入力（デフォルト: 1）

3. 「リストに追加」ボタンをクリック

### 5. 複数商品の追加

必要に応じて、手順4を繰り返して複数の商品をリストに追加できます。

- **選択項目を削除**: リストから特定の商品を削除
- **リストをクリア**: リスト内のすべての商品を削除

### 6. 変換実行

「変換実行」ボタンをクリックすると、処理が開始されます。

- 各商品の情報を順次取得（進捗が表示されます）
- 取得完了後、自動的にExcelファイルに書き込み
- 完了メッセージが表示されたら完了

### 7. Excelファイルの確認

出力されたExcelファイルには、以下の列が含まれます：

| 仕入元 | 商品コード | 商品名 | 型番 | 単価 | 数量 | 合計 | URL | 価格(税込) |
|--------|------------|--------|------|------|------|------|-----|------------|

## 注意事項

### 利用時の注意

1. **情報取得の確実性**: Webページの構造変更により情報が取得できない場合があります



#### Excelファイルが開けない場合

- ファイルが他のアプリケーションで開かれていないか確認してください
- 書き込み権限があるフォルダに保存しているか確認してください

## プログラムの追加機能

- 新しい機能を追加したい場合は、新規でプログラムを作成し、瀧にgithubでプルリクエストを送信するか、直接渡してください。

## build.batについて

使い方：
monotaro.pyを編集する→build.batを実行（右クリックして開く）→monotaro.pyがexeに変換される
結果：
exeができる